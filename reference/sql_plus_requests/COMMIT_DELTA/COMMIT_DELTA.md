---
layout: default
title: COMMIT DELTA
nav_order: 11
parent: Запросы SQL+
grand_parent: Справочная информация
has_children: false
has_toc: false
---

# COMMIT DELTA

Запрос закрывает открытую (горячую) [дельту](../../../overview/main_concepts/delta/delta.md). 
Дата и время закрытия дельты могут быть указаны в запросе или установлены системой.

Перед выполнением запроса необходимо определить логическую базу данных, 
[используемую по умолчанию](../../../working_with_system/other_features/default_db_set-up/default_db_set-up.md), 
если она еще не определена.

В ответе возвращается:
* объект ResultSet c одной записью, содержащей информацию о дате и времени закрытия дельты, 
  при успешном выполнении запроса;
* исключение при неуспешном выполнении запроса.

Для дельты устанавливаются следующие дата и время закрытия:
* указанные в запросе, если они указаны и корректны,
* определенные системой, если дата и время не указаны в запросе.

При успешном выполнении запроса горячие записи дельты становятся актуальными, 
а зафиксированные ранее записи, которые больше не являются актуальными, — архивными. 
Дельта закрывается и становится недоступна для изменения, а [логическая схема данных](../../../overview/main_concepts/logical_schema/logical_schema.md), 
наоборот, становится доступна для изменения. 

Подробнее о версионировании записей см. в разделе [Версионирование данных](../../../working_with_system/data_upload/data_versioning/data_versioning.md).
{: .note-wrapper}

Горячую дельту невозможно закрыть или откатить, пока в ней есть незавершенные операции записи. Незавершенную операцию
можно перезапустить или отменить:
* чтобы отменить операцию, выполните запрос [ERASE_WRITE_OPERATION](../ERASE_WRITE_OPERATION/ERASE_WRITE_OPERATION.md);
* чтобы перезапустить операцию:
  * выполните запрос [RESUME_WRITE_OPERATION](../RESUME_WRITE_OPERATION/RESUME_WRITE_OPERATION.md) — если операция была 
    запущена запросом [загрузки данных](../../../working_with_system/data_upload/data_upload.md); 
  * повторите исходный запрос, добавив в начало запроса ключевое слово `RETRY`, — если операция была запущена запросом 
    [обновления данных](../../../working_with_system/data_update/data_update.md).

Наличие незавершенных операций можно проверить с помощью запроса 
[GET_WRITE_OPERATIONS](../GET_WRITE_OPERATIONS/GET_WRITE_OPERATIONS.md).
{: .note-wrapper}

## Синтаксис {#syntax}

Закрытие открытой дельты:
```sql
COMMIT DELTA
```

Закрытие открытой дельты с указанными датой и временем закрытия:
```sql
COMMIT DELTA SET date_time_expression
```

**Параметры:**

`date_time_expression`

: Метка даты и времени вида `'YYYY-MM-DD hh:mm:ss'`. Возможные форматы см. в разделе
  [Форматы даты и времени](../../timestamp_formats/timestamp_formats.md).

## Ограничения {#restrictions}

Если в запросе указаны дата и время закрытия дельты, они должны быть больше, чем дата и время последней 
закрытой дельты логической базы данных. Дату и время последней закрытой дельты можно узнать, выполнив запрос 
[GET_DELTA_OK](../GET_DELTA_OK/GET_DELTA_OK.md).

## Пример {#examples}

```sql
COMMIT DELTA SET '2021-03-21 09:29:54'
```